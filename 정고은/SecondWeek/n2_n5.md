# 2장 인터넷이란?

현재 사용하고 있는 인터넷이 준수하는 프로토콜 = TCP/IP

+)

TCP/IP에 대한 자습

#### 서론

네트워크 - 여러 객체가 서로 정보를 교환하는 것

인터넷 - 네트워크를 컴퓨터와 컴퓨터로 구성한 것.

IP - 전 세계 수억대의 컴퓨터가 인터넷을 하기 위해서는 서로의 정체를 알 수 있도록 특별한 주소를 부여했는데 이 주소를 IP주소라고 함. 4개의 숫자로 구성되며 숫자의 크기에 따라 IPv4(32비트, 각 숫자는 1바이트, .으로 자리구분), IPv6(128비트, 각 숫자는 4바이트, :으로 자리구분)로 나뉜다.

* 패킷: 데이터를 일정한 크기로 자른단위로 인터넷에서 정보를 전달하는 단위이다. 나누어진 패킷이 순서대로 도착한다는 보장이 없으므로 규칙이 필요하다.

TCP - 전달받은 패킷을 재조립하고, 패킷에 손상이 있거나 손실된 패킷이 있다면 재전송을 요구하는 패킷을 전송해 재전송받는다.

#### TCP/IP

TCP는 데이터의 흐름을 제어할 수는 있지만 데이터가 전송되어야 할 경로에 대한 규약은 아니기 때문에 경로에 대한 규약인 IP를 함께 사용한다. 그래서 TCP/IP이다.

TCP/IP가 많이 사용되며 OSI 7계층을 더 추상화한 TCP/IP 4계층이 등장했다.

*이거 TCP/IP 4계층이 두 종류..? 로 둘이 차이나던데 왜 그런가요..* 물리 계층을 네트워크 서비스라고 말하는 것도 있고 잉..

![tcpip4](mdImages\tcpip4.png)

응용 계층(Application Layer) - 프로그램(브라우저)가 직접 인터액트하는 레이어, 데이터를 처음으로 받는 곳, HTTP, SMTP-메일-, FTP-파일-, Telnet-원격- 등의 프로토콜을 가진다. OSI 계층의 Application Layer와 Presentation Layer를 모두 포함한다.

전송 계층(Transport Layer) - TCP와 UDP가 있는 레이어. 포트를 통하여 Application 레이어가 TCP에게 데이터를 전송한다. 각각의 포트에 프로토콜을 지정할 수 있다. ex) http - 80 포트. 이로써 TCP는 어디에서 데이터가 오는지 정확히 알 수 있다. 포트를 통해 받은 데이터들은 패킷으로 쪼개진다. 패킷들은 제각각 가장 빨리 전송될 수 있는 인터넷 루트를 찾아 떠난다. 각각의 패킷들은 TCP header에 어떤 순서로 재조합 할지에 관한 정보를 가진다. OSI 모델의 Session Layer와 Transport Layer를 포함한다.

인터넷 계층(Internet Layer) - 패킷들이 인터넷 레이어에 push된다. IP를 사용하여 데이터의 원천지(origin)과 목적지(destination)에 관한 정보를 첨부한다. ICMP, IP 등이 있다. OSI의 NetworkLayer와 Data Link Layer를 포함한다.

물리 계층(Physical Layer) - 이더넷 카드와 같은 하드웨어.

TCP/IP 프로토콜로 데이터를 전송하면 전송되는 패킷은 TCP/IP 4계층을 따라 내려가며 TCP-IP-이더넷 순서로 헤더가 붙고, 데이터를 수신하는 측은 반대로 TCP/IP 4계층을 따라 올라가며 데이터에 붙어있는 헤더를 이더넷-IP-TCP 순서로 제거한다.

연결지향이란

TCP/iP에 의해 데이터가 전송되기 전에, browser와 server 간의 연결이 성립하는 과정이 데이터를 전송하는 과정 전에 이루어지게 된다. 먼저 browser는 server에 "서버 있니?"라고 메세지를 보내고 server는 다시 browser에게 "서버 있음 데이터 좀요"라고 메세지를 보내고 browser는 서버에게 "ㅇㅋ 데이터 갑니다"라고 서로의 존재를 확인하는 절차를 수행한 후, 정식 데이터를 교환하기 위한 통신선로를 개설하게 된다. 통신선로를 하나 만들기 위해서는 3번의 데이터 전송이 일어나게 되므로, 이것을 three way handshake라고 한다.

이렇게 연결이 이루어지면 모든 정식데이터는 연결된 통신선로를 통해서 교환하게 되며, 연결 지향 프로토콜이라고 부른다. UDP는 이러한 과정 없이 단순히 데이터만을 전송함으로 데이터 그램 프로토콜이라고 부른다. 

#### OSI 7계층, 이더넷 뜻?

OSI 7계층 - OSI를 계층별로 나눔으로써 각 계층에 필요한 부분만을 개발자들이 신경쓰게 되고 통신서비스 개발시간을 줄일 수 있도록 도와준다. 또한 7단계 중 특정한 곳에 이상이 생기면 다른 단계의 장비 및 소프트웨어를 건들이지 않고도 이상이 생긴 단계만 고칠 수 있기 때문이다.

에시

```
PC방에서 롤을 하는데 연결이 끊어졌다.
어디에 문제가 있는지 확인하기 위해서는
모든 PC에 문제가 있다면 라우터의 문제(3계층 네트워크 게층)이거나 광랜을 제공하는 회사의 회선 문제(1계층 물리 계층)
한 pc만 문제가 있고 롤 소프트웨어에 문제가 있다면(7계층 어플리케이션 계층) 롤 소프트웨어에 문제가 없고, 스위치에 문제가 있으면(2계층 데이터링크 계층)에 있다고 판단해 다른 계층에 있는 장비나 소프트웨어를 건들이지 않는 것이다.
```

##### 7계층 - 응용 계층(Application Layer)

최종 목적지로서 HTTP, SMTP, Telnet 등과 같은 프로토콜이 있다.

모든 통신의 양 끝단은 HTTP와 같은 프로토콜이지 브라우저나 메일 프로그램 등의 응용프로그램이 아니다.

응용 계층은 일반적인 응용 서비스를 수행한다. 일반적인 응용 서비스는 관련된 응용 프로세스들 사이의 전환을 제공한다. 응용 서비스의 예로, 가상터미널(예를 들어 텔넷) 등이 있다. 

-> 네트워크 소프트웨어 UI 부분, 사용자의 입출력(I/O) 부분

##### 6계층 - 표현 계층(Presentation Layer)

데이터 표현이 상이한 응용 프로세스의 독립성을 제공하고, 암호화한다.

표현 계층은 코드 간의 번역을 담당해 사용자 시스템에서 데이터의 형식상 차이를 다루는 부담을 응용 계층으로부터 덜어 준다. MIME 인코딩-메일-이나 암호화 등의 동작이 이 계층에서 이루어진다. 예를 들면 EBCDIC으로 인코딩된 문서 파일을 ASCII로 인코딩된 파일로 바꿔 주는 것, 해당 데이터가 TEXT인지, 그림인지, GIF인지 JPG인지의 구분 등이 표현 계층의 몫이다.

-> 사용자의 명령어를 완성 및 결과 표현, 포장/압축/암호화

##### 5계층 - 세션 계층(Session Layer)

데이터가 통신하기 위한 논리적인 연결

하지만 4계층에서도 연결을 맺고 종료할 수 있기 때문에 어느 계층에서 통신이 끊어졌나 판단하기에는 한계가 있다. 그러므로 세션 계층은 4계층과 무관하게 응용 프로그램 관점에서 봐야한다.

세션 설정, 유지, 종류, 전송 중단시 복구 등의 기능이 있다.

양 끝단의 응용 프로세스가 통신을 관리하기 위한 방법을 제공한다.

동시 송수신 방식, 반이중 방식, 전이중 방식의 통신과 함께, 체크 포인팅과 유휴, 종료, 다시 시작 과정 등을 수행한다. 이 계층은 TCP/IP 세션을 만들고 없애는 책임을 진다.

-> 통신하는 사용자들을 동기화하고 오류복구 명령들을 일괄적으로 다룬다. 통신을 하기 위한 세션을 확립/유지/중단 (운영체제가 해줌)

##### 4계층 - 전송 계층(Transport Layer)

통신을 활성화하기 위한 계층.

보통 TCP 프로토콜을 이용하며, 포트를 열어서 응용프로그램들이 전송을 할 수 있게 한다.

만약 데이터가 왔다면 4계층에서 해당 데이터를 하나로 합쳐서 5계층에 던져 준다.

전송 계층은 양 끝단의 사용자들이 신뢰성 있는 데이터를 주고 받을 수 잇도록 해주어, 상위 게층이 데이터 전달의 유효성이나 효율성을 생각하지 않도록 해준다.

전송 계층은 특정 연결의 유효성을 제어하고, 일부 프로토콜은 상태 개념이 있고(stateful), 연결 기반이다. 이는 전송 계층이 패킷들의 전송이 유효한지 확인하고 전송 실패한 패킷들을 다시 전송한다는 것을 뜻한다. 

종단간 통신을 다루는 최하위 계층으로 종단간 신뢰성있고 효율적인 데이터를 전송하며, 기능은 오류검출 및 복구와 흐름제어, 중복검사 등을 수행한다.

-> 패킷 생성 및 전송

##### 4.1 TCP 프로토콜

양종단 호스트 내 프로세스 상호 간에 신뢰적인 연결지향성 서비스를 제공

- IP의 비신뢰적인 최선형 서비스에다가 신뢰적인 연결지향성 서비스를 제공하게 됨
- 신뢰적인 전송을 보장함으로써, 어플리케이션 구현이 한층 쉬워지게 됨

1. 신뢰성있음

패킷 손실, 중복, 순서바뀜 등이 없도록 보장

 TCP 하위계층인 IP 계층의 신뢰성 없는 서비스에 대해 다방면으로 신뢰성을 제공

2. 연결지향적

같은 전송계층의 UDP가 비연결성인 것과는 달리, TCP는 연결지향적이다.

이 경우, 느슨한 연결을 갖으므로 강한 연결을 의미하는 가상회선이라는 표현보다는 오히려 연결지향적이라고 말함.

연결 관리를 위한 연결설정 및 연결해제 필요 -> TCP 연결설정, TCP 연결종료

양단간 어플리케이션/프로세스는 TCP가 제공하는 연결성 회선을통하여 서로 통신

##### 4.2 UDP 프로토콜

- 신뢰성이 낮은 프로토콜로써 완전성을 보증하지 않으나, 가상회선을 굳이 확립할 필요가 없고 유연하며 효율적 응용의 데이터 전송에 사용

1. 비연결성이고, 신뢰성이 없으며, 순서화되지 않은 데이터그램 서비스 제공

- 메세지가 제대로 도착했는지 확인하지 않음 (확인응답 없음)
- 수신된 메세지의 순서를 맞추지 않음 (순서제어 없음)
- 흐름 제어를 위한 피드백을 제공하지 않음 (흐름제어 없음)
- 검사합을 제외한 특별한 오류 검출 및 제어 없음 (오류 제어 거의 없음)

UDP를 사용하는 프로그램 쪽에서 오류제어 기능을 스스로 갖추어야 함

- 데이터그램 지향의 전송계층용 프로토콜 (논리적인 가상회선 연결이 필요없음)
- 비연결접송상태 하에서 통신

2. 실시간 응용 및 멀티태스킹 가능

- 빠른 요청과 응답이 필요한 실시간 응용에 적합
- 여러 다수 지점에 전송 가능 (1:다)

3. 헤더가 단순함

- UDP는 TCP처럼 16비트의 포트 번호를 사용하나, 헤더는 고정 크기의 8바이트(TCP는 20바이트)만 사용. 즉, 헤더 처리에 많은 시간과 노력을 요하지 않음.

##### 3계층 - 네트워크 계층(Network Layer)

이 계층에서 가장 중요한 기능 - 데이터를 목적지까지 가장 안전하고 빠르게 전달하는 기능(라우팅)이다.

이 계층은 경로를 선택하고 주소를 정하고 경로에 따라 패킷을 전달해주는 것이 이 계층의 역할이다. 대표적인 장비는 라우터이며 요즘은 2계층의 장비 중 스위치에 라우팅 기능을 장착한 Layer 3 스위치도 있다. 여기서는 IP주소를 사용한다.

+) 인터넷에서 노드를 정의할 때 노드는 IP 주소를 보유한 어떠한 것도 될 수 있다.

네트워크 계층은 여러개의 노드를 거칠때마다 경로를 찾아주는 역할을 하는 계층으로 다양한 길이의 데이터를 네트워크들을 통해 전달하고, 그 과정에서 전송 계층이 요구하는 서비스 품질(QoS)를 제공하기 위한 기능정, 절치적 수단을 제공한다.

네트워크 계층은 라우팅, 흐름 제어, 세그멘테이션, 오류 제어, 인터네트워킹 등을 수행한다. 라우터가 이 게층에서 동작하고 이 게층에서 동작하는 스위치도 있다.

데이터를 연결하는 다른 네트워크를 전달함으로써 인터넷이 가능하게 만드는 계층이다. 논리적인 주소 구조(IP), 곧 네트워크 관리자가 직접 주소를 할당하는 구조를 가지며, 계층적이다.

서브네트의 최상위 계층으로 경로를 설정하고, 청구 정보를 관리한다. 개방형 시스템들의 사이에서 네트워크 연결을 설정, 유지, 해제하는 기능을 부여하고, 전송 계층 사이에 네트워크 서비스 데이터 유닛(NSDU)을 교환하는 기능을 제공한다.

-> 주소부여(IP), 경로설정(Route)

##### 3.1 IP계층

TCP/IP 상에서 IP계층이란 네트워크 주소(IP 주소)를 정의하고, IP 패킷의 전달 및 라우팅을 담당하는 계층.

패킷을 목적지까지 전달하는 역할 및 그에 수반되는 기타 역할을 함.

IP계층에서는 그 하위계층인 데이터링크 계층의 하드웨어적인 특성에(ATM이든 Frame Relay든 상관없이) 독립적인 역할을 수행

주요 프로토콜 : 패킷의 전달을 책임지는 IP, 패킷 전달의 에러의 보고 및 진달을 위한 ICMP, 복잡한 네트워크에서 인터네트워킹을 위한 경로를 찾게해주는 라우팅 프로토콜

##### 3.2 IP 프로토콜

TCP/IP 기반의 인터넷 망을 통하여 데이터그램의 전달을 담당하는 프로토콜

주요 기능 - IP 계층에서 IP 패킷의 라우팅 대상이 됨 (Routing), IP주소 지정(Adressing)

신뢰성(에러제어) 및 흐름제어 기능이 전혀 없음 - Best-Effort Service. 신뢰성을 확보하려면 IP 계층 위의 TCP와 같은 상위 프랜스포트 계층에 의존

비연결성 데이터그램 방식으로 전달되는 프로토콜 - Connectionless

패킷의 완전한 전달(소실, 중복, 지연, 순서바뀜 등이 없게함)을 보장하지 않음 - Unrealiable

IP 패킷 헤더 내 수신 및 발신 주소를 포함 - IPv4 헤더, IPv6 헤더, IP 주소

TCP, UDP, ICMP, IGMP 등이 IP 데이터그램에 실려서 전송

##### 2계층 - 데이터 링크계층(DataLink Layer)

물리계층을 통해 송수신되는 정보의 오류와 흐름을 관리해 안전한 정보의 전달을 수행할 수 있도록 도와주는 역할. 따라서 통신에서의 오류도 찾아주고 재전송도 하는 기능을 가지고 있다.

<b>맥주소</b>를 가지고 통신하게 된다.

이 게층에서 전송되는 단위를 프레임이라고 하고, 대표적인 장비로는 브릿지, 스위치 등이 있다. (여기서 MAC 주소를 사용한다.)

-> 브릿지나 스위치를 통해 맥주소를 가지고 물리게층에서 받은 정보를 전달함.

포인트 투 포인트간 신뢰성있는 전송을 보장하기 위한 계층으로 CRC 기반의 오류 제어와 흐름 제어가 필요하다. 네트워크 위의 개체들 간 데이터를 전달하고, 물리 게층에서 발생할 수 있는 오류를 찾아내고, 수정하는데 필요한 기능적, 절차적 수단을 제공한다.

주소 값은 물리적으로 할당 받는데, 이는 네트워크 카드가 만들어질 때부터 맥 주소(MAC address)가 정해져있다는 뜻이다. 주소 체계는 게층이 없는 단일 구조이다. 데이터 링크 계층의 가장 잘 알려진 예는 <b>이더넷</b>이다.

-> 프레임에 주소부여(MAC - 물리적주소), 에러검출/재전송/흐름제어

##### 이더넷이란?

우선 LAN이란 어느 한정된 공간에서 네트워크를 구성한다는 것이다.

WAN은 멀리 떨어진 지역을 연결하는 경우에 사용한다.

인터넷에 접속하는 것은 WAN이라고 봐야 할 것이다. 요즘은 네트워킹을 한다고 하면 주로 LAN과 WAN이 공존한다.

이더넷은  LAN에서 가장 많이 활용되는 기술 규격. OSI 모델의 물리 게층에서 신호와 배선, 데이터 링크 계층에서 MAC 패킷과 프로토콜의 형식을 정의한다.

네트워크에 연결된 각 기기들이 48비트의 고유의 MAC주소를 가지고 이 주소를 이용해 상호간에 데이터를 주고 받을 수 있도록 만들어졌다. 각 기기를 상호 연결시키는 데에는 허브, 스위치, 리피터 등의 장치를 이용한다.

가장 큰 특징은 CSMA/CD(Carrier Sense Mutliple Access/Collision Detection)라는 프로토콜을 사용해서 통신한다는 것이다.

이더넷 환경에서 통신을 하고 싶은 PC나 서버는 먼저 지금 네트워크 상에 통신이 일어나고 있는지를 확인한다. 이것을 CS(carrier Sense)라고 한다. 만약 두 개 이상의 PC나 서버가 동시에 네트워크 상에 데이터를실어 보내는 경우를 MA(Multiple Access)라고 한다. 통신에서는 이렇게 두 개의 장비들이 데이터를 동시에 보내려다가 부딪치는 경우를 충돌(Collision)이 발생했다고 한다. 만약 충돌이 발생하게 되면 전송했던 PC들은 랜덤한 시간동안 기다린 다음 다시 데이터를 전송하게 된다. 그래서 이더넷에서는 너무 많은 충돌이 발생하면 통신 자체가 불가능해지는 경우도 생길수 있다.

#### 1계층 - 물리계층(Physical Layer)

이 계층에서는 주로 전기적, 기계적, 기능적인 특성을 이용해 통신 케이블로 데이터를 전송하게 된다. 이 계층에서 사용되는 통신 단위는 비트이며 이것은 1과 0으로 나타내어지는, 즉 전기적으로 On, Off 상태라고 생각하면 된다.

이 계층에서는 단지 데이터를 전달만 할뿐 전송하려는(또는 받으려는) 데이터가 무엇인지, 어떤 에러가 있는지 등에는 전혀 신경쓰지 않는다.

단지 데이터 전기적인 신호로 변환해서 주고받는 기능만 할 뿐이다. 이 계층에 속하는 대표적인 장비는 통신 케이블, 리피터, 허브 등이 있다.

-> 케이블, 리피터, 허브를 통해 데이터 전송한다.

### 소켓 계층이란?

socket 계층

네트워크 프로그램 개발을 위한 TCP/IP 4계층에서 더 추상화해서 만들어진 계층. 프로그래머를 위해 만들어진 계층으로 소켓 계층은 소켓 함수 라이브러리를 말하며, 소켓 프로그래밍이란, 이 라이브러리를 사용해서 프로그래밍하는 것을 말한다.

서버 - socket(), bind(), listen(), accept(), read()/write(), close()

클라이언트 - socket(),        connect()     , read()/write(), close()

socket() - socket을 만든다. 만들어진 소켓은 소켓 지정번호를 가지며 아직 아무런 ip주소, port번호와도 연결되지 않은 상태이다.

bind() - 만들어진 소켓을 ip주소, port번호와 연결(bind)한다. 연결된 소켓으로 이제 통신이 가능하다.

listen() - 서버가 클라이언트의 연결을 기다린다.

accept() - 서버가 클라이언트의 연결을 받아들인다.

connet() - 클라이언트가 서벙 서버의 ip주소와 port번호로 연결을 시도한다.

read()/write() - 서버와 클라이언트가 서로에게 데이터를 주고 받는다.

close() - 다 사용한 소켓을 종료한다.

#### UDP Sockt Programming

서버 - socket(), bind(), recvfrom(), sendto()

클라이언트 - socket(), sendto(), recvfrom(), close()

1. 서버 - bind()함수를 통해 특정 포트를 사용하고 선언한 다음 데이터가 전송되기를 기다린다.
2. 클라이언트 - 서버에 출발지 IP, 포트를 함께 담아 데이터를 전송한다.
3. 서버 - 데이터와 함께 출발지 IP, 포트를 분석해 알맞은 경우 특정 동작을 수행하고, 필요하다면 해당 IP, 포트로 다시 어떤 정보를 전송한다. 

# 3장 서버와 클라이언트

서버 - 응답함

클라이언트 - 요청해서 받음

예를 들어 클라이언트가 http://www.example.com:80을 열어줘! 라고 요청하면 서버는 응답을 해준다. 아마 index.html을 보여주지 않을까..?

# 4장 웹

### URL

웹에 게시된 어떠한 자원을 찾기 위해 브라우저에서 사용되는 메커니즘.

ex. http://www.example.com:80/path/to/myfile.html?key1=value&key2=value2#SomewhereInTheDocument

여기서 http는 프로토콜이다. 보통 http나 https이다. 그러나 mailto:(메일) 또는 파일 전송을 위한 ftp:와 같은 프로토콜도 있다.

www.example.com은 도메인 이름이다. ip address도 가능하다. 그냥 도메인 쓰자.

/path/to/myfile.html

자원에 대한 경로. 요즘은 실제 경로가 아닌 추상화해서 보여준다.

?key1=value1&key2=value2

웹서버에 제공하는 추가 파라미터. 키/값으로 짝을 이룬 리스트이다. 

#SomewhereInTheDocument

자원 자체의 다른 부분에 대한 anchor이다. 북마크 같은 느낌. 예시가 나무위키밖에 생각이 안나는데 1. 정의 를 누르면 그 페이지 안에서 # 정의 이쪽을 가는 느낌. 

### HTML - Hypertext Markup Language

웹 콘텐츠의 의미와 구조를 정의할 때 사용. 외형은 CSS, 기능과 동작은 JS가 있다. 마크업 언어.

URLs를 광범위하게 사용하게 만들었다.

HTML 요소는 문서의 다른 텍스트와 "태그"로 구분한다. < "태그이름" >. 대소문자 구별 x

- <a> 요소로 다른 문서와의 링크를 만들기 위해
- <link> 또는 <script> 처럼 다양한 요소를 통해서 관련된 자원을 가진 문서를 연결시키기 위해
- <img>, <video>, <audio>
- <.iframe> 요소를 다른 HTML 문서에 보여주기 위해

### HTTP

프로토콜(원활한 통신을 위해 미리 정의한 규약). 네트워크에서 데이터를 교류하기 위한 방법들의 집합이다.

http는 클라이언트-서버 프로토콜(보통 웹 브라우저인 수신자 측에 의해 요청이 초기화되는 프로토콜)

# 5장 브라우저

C언어의 번역기 -> 컴파일러, HTML & CSS -> 렌더링 엔진, JS -> 자바스크립트 엔진

ip주소를 외울 수 없으니 도메인을 사용한다. 만약 ip를 제대로 친다면 친숙한 도메인(www.naver.com) 등을 띄울 수도 당근 있다.

DNS - 도메인의 IP정보를 저장하여 사용자에게 제공하는 서비스.

만약 www.naver.com을 쳐서 dns서버에 요청을 보내면 dns서버가 사용자의 컴퓨터에 ip주소를 알려주고 전달받은 ip주소로 요청을 보내 사이트에 접속하게 된다.



갑자기 궁금해져서 도메인 관리하는 곳에서 jeonggo.com을 봤는데 궁금점을 정리해서 알아봤다.

- A레코드란? 

  IPv4 주소를 매칭할 때 사용하는 레코드. 하나의 Domain Name에 여러 개의 IP 주소를 등록할 수 있다.

  예를들어 jeonggo.com 소유자는 jeonggo.com 및 그 하위 도메인(api.jeonggo.com, bible.jeonggo.com 등)에 원하는 IP 주소를 지정할 수 있다.

- DDNS란?

  실시간으로 DNS를 갱신하는 방식. 도메인의 ip가 유동적인 경우 사용된다. ip가 바뀌어도 DDNS로 설정한 도메인값은 변하지 않기 때문에 접속 가능하다.

- 네임서버란?

  DNS를 운영하는 서버